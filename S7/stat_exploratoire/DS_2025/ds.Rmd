---
title: "DS 2025"
author: "Simon Desdevises"
date: "2025-09-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r load_data}
data <- read.csv("/Users/simondesdevises/Documents/Polytech/IS2A/S7/stat_exploratoire/DS_2025/data.csv", header = TRUE) # nolint
rownames(data) <- data[, 1]
data <- data[, -1]
```

# Question 1 - Quelle est la transformation à appliquer pour faire une ACP normée ?

Pour faire une ACP normée, on doit centrer et réduire les variables.

```{r normalize_data}
data_normalized <- scale(data, center = TRUE, scale = TRUE)
```

# Question 2 - Quelles sont les coordonnées du centre de gravité du nuage des sujets ?

```{r center_of_gravity}
center_of_gravity <- colMeans(data)
```

Les coordonnées du centre de gravité du nuage des sujets sont : `r center_of_gravity`.

# Question 3 - Comment peut-on calculer la matrice des corrélations linéaires entre les différentes matières à partir du tableau transformé ?

La matrice des corrélations linéaires entre les différentes matières à partir du tableau transformé peut être calculée en utilisant la fonction `cor` de R.

```{r correlation_matrix}
correlation_matrix <- cor(data_normalized)
```

# Question 4 - En utilisant le critère de Kaiser, combien d'axes faut-il retenir ?

Pour le critère de Kaiser, on doit retenir les axes dont les valeurs propres sont supérieures à 1.

```{r eigen_values}
eigen <- eigen(correlation_matrix)
barplot(eigen$values)
```

Dans notre cas, on doit retenir les `r sum(eigen$values > 1)` premiers axes.

# Question 5 - Calculer la qualité de représentation des matières sur les axes retenus

```{r quality_representation}
coordonnees_individus <- data_normalized %*% eigen$vectors
distances_carrees <- rowSums(coordonnees_individus^2)
qualite_repr <- matrix(0, nrow = nrow(coordonnees_individus), ncol = 5)
for (i in 1:5) {
  qualite_repr[, i] <- coordonnees_individus[, i]^2 / distances_carrees
}
```

La qualité de représentation des matières sur les axes retenus est :
```{r quality_representation_matrix}
knitr::kable(qualite_repr[, 1:3])
```

# Question 6 - Interpréter chacun des 3 axes par rapport aux matières et donner une phrase résumant l'axe concerné

# Question 7 - En utilisant les cercles de corrélations linéaire formé par les axes 1 et 2:

## A - Quel phénomène peut-on observer sur l'axe 1 ?

```{r correlation_circle_1}
plot(eigen$vectors[, 1], eigen$vectors[, 2],
     xlab = "Axe 1",
     ylab = "Axe 2",
     main = "Cercle des corrélations linéaires")
```

